angular.module("ivh.multiSelect",["selectionModel"]),angular.module("ivh.multiSelect").directive("ivhMultiSelectAsync",function(){"use strict";return{scope:{items:"=ivhMultiSelectItems",labelAttr:"=ivhMultiSelectLabelAttribute",labelExpr:"=ivhMultiSelectLabelExpression",selectionModelType:"=",selectionModelMode:"=",selectionModelSelectedAttribute:"=",selectionModelSelectedClass:"=",selectionModelCleanupStrategy:"=",selOnChange:"&selectionModelOnChange"},restrict:"AE",template:'\n<div class="ivh-multi-select dropdown" ng-class="{open: ms.isOpen}"\nivh-multi-select-collapsable>\n<button class="btn btn-default dropdown-toggle" type="button"\nivh-multi-select-stay-open\nng-click="ms.isOpen = !ms.isOpen">\n<span ng-transclude></span>\n<span class="caret"></span>\n</button>\n<ul class="dropdown-menu" role="menu" ng-if="ms.isOpen"\nivh-multi-select-stay-open>\n<li role="presentation" ivh-multi-select-tools></li>\n<li role="presentation" ivh-multi-select-filter></li>\n<li role="presentation" class="divider"></li>\n<li role="presentation" class="ms-item"\nng-repeat="item in ms.items = (items | filter:ms.filterString) | ivhMultiSelectPaginate:ms.ixPage:ms.sizePage"\nselection-model\nselection-model-mode="ms.sel.mode"\nselection-model-type="ms.sel.type"\nselection-model-selected-attribute="ms.sel.selectedAttribute"\nselection-model-selected-attribute="ms.sel.selectedAttribute"\nselection-model-on-change="ms.sel.onChange(item)">\n<a role="menuitem">\n<!-- Must stop propagation on checkbox clicks when nested within the `a`\ntag otherwise `a` fires a click too and undoes the first click. We\nwant to honor the actual checkbox click. -->\n<input type="checkbox" ng-click="$event.stopPropagation()" />\n{{:: ms.getLabelFor(item)}}\n</a>\n</li>\n<li role="presentation" ng-hide="ms.items.length"\nivh-multi-select-no-results>\n</li>\n<li role="presentation" ng-if="ms.hasPager && ms.items.length > ms.sizePage">\n<div class="text-center"\nivh-pager\nivh-pager-total="ms.items.length"\nivh-pager-page-number="ms.ixPage"\nivh-pager-page-size="ms.sizePage"\nivh-pager-button-size="\'sm\'">\n</div>\n</li>\n</ul>\n</div>\n',transclude:!0,controllerAs:"ms",controller:["$document","$scope","$injector","$interpolate","filterFilter","ivhMultiSelectSelm",function(a,b,c,d,e,f){var g=this,h=10,i=!0;g.sel=f.options(b),g.enableMultiSelect="single"!==g.sel.mode,angular.forEach([["type","selectionModelType"],["mode","selectionModelMode"],["selectedAttribute","selectionModelSelectedAttribute"],["selectedClass","selectionModelSelectedClass"],["cleanupStategy","selectionModelCleanupStrategy"]],function(a){var c=b.$watch(a[1],function(b){b&&(g.sel[a[0]]=b,"mode"===a[0]&&(g.enableMultiSelect="single"!==b))});b.$on("$destroy",c)}),g.sel.onChange=function(a){b.selOnChange({item:a})};var j=b.labelAttr||"label",k=b.labelExpr?d(b.labelExpr):null;g.getLabelFor=function(a){return k?k({item:a}):a[j]},g.isOpen=!1,g.items=b.items,g.filterString="",g.hasPager=i&&c.has("ivhPaginateFilter"),g.ixPage=0,g.sizePage=h,g.selectAllVisible=function(a){a=angular.isDefined(a)?a:!0;var b=g.sel.selectedAttribute;angular.forEach(g.items,function(c){c[b]=a,g.sel.onChange(c)})};var l=a.find("body"),m=function(a){var c=a.originalEvent||a;c.ivhMultiSelectIgnore||(g.isOpen=!1,b.$digest())};l.on("click",m),b.$on("$destroy",function(){l.off("click",m)})}]}}),angular.module("ivh.multiSelect").directive("ivhMultiSelectAutofocus",["$timeout",function(a){"use strict";return{restrict:"A",link:function(b,c,d){a(function(){c[0].focus()})}}}]),angular.module("ivh.multiSelect").directive("ivhMultiSelectCollapsable",["$document",function(a){"use strict";return{restrict:"A",require:["?^ivhMultiSelect","?^ivhMultiSelectAsync"],link:function(b,c,d,e){var f=a.find("body"),g=function(a){var c=a.originalEvent||a;c.ivhMultiSelectIgnore||(angular.forEach(e,function(a){a&&(a.isOpen=!1)}),b.$digest())};f.on("click",g),b.$on("$destroy",function(){f.off("click",g)})}}}]),angular.module("ivh.multiSelect").directive("ivhMultiSelectFilter",function(){"use strict";return{restrict:"A",template:'<a class="ms-tools">\n<input class="form-control" type="text"\nplaceholder="Search..."\nng-model="ms.filterString"\nng-model-options="{debounce: 200}"\nivh-multi-select-autofocus />\n</a>\n'}}),angular.module("ivh.multiSelect").directive("ivhMultiSelectNoResults",function(){"use strict";return{restrict:"A",template:'<a class="ms-tools">\n<em class="text-muted">\nNothing to show\n</em>\n</a>\n'}}),angular.module("ivh.multiSelect").directive("ivhMultiSelectStayOpen",function(){"use strict";return{restrict:"A",link:function(a,b,c){b.on("click",function(a){var b=a.originalEvent||a;b.ivhMultiSelectIgnore=!0})}}}),angular.module("ivh.multiSelect").directive("ivhMultiSelectTools",function(){"use strict";return{restrict:"A",template:'<a class="ms-tools">\n<button class="btn btn-default btn-sm"\nng-click="ms.enableMultiSelect && ms.selectAllVisible()"\nng-class="{disabled: !ms.enableMultiSelect}">\n<span class="glyphicon glyphicon-ok"></span>\nAll\n</button>\n<button class="btn btn-default btn-sm"\nng-click="ms.enableMultiSelect && ms.selectAllVisible(false)"\nng-class="{disabled: !ms.enableMultiSelect}">\n<span class="glyphicon glyphicon-remove"></span>\nNone\n</button>\n<button class="btn btn-default btn-sm"\nng-show="ms.filterString.length"\nng-click="ms.filterString = \'\'">\nClear\n</button>\n</a>\n'}}),angular.module("ivh.multiSelect").directive("ivhMultiSelect",function(){"use strict";return{scope:{items:"=ivhMultiSelectItems",labelAttr:"=ivhMultiSelectLabelAttribute",labelExpr:"=ivhMultiSelectLabelExpression",selectionModelType:"=",selectionModelMode:"=",selectionModelSelectedAttribute:"=",selectionModelSelectedClass:"=",selectionModelCleanupStrategy:"=",selOnChange:"&selectionModelOnChange"},restrict:"AE",template:'\n<div class="ivh-multi-select dropdown" ng-class="{open: ms.isOpen}"\nivh-multi-select-collapsable>\n<button class="btn btn-default dropdown-toggle" type="button"\nivh-multi-select-stay-open\nng-click="ms.isOpen = !ms.isOpen">\n<span ng-transclude></span>\n<span class="caret"></span>\n</button>\n<ul class="dropdown-menu" role="menu" ng-if="ms.isOpen"\nivh-multi-select-stay-open>\n<li role="presentation" ivh-multi-select-tools></li>\n<li role="presentation" ivh-multi-select-filter></li>\n<li role="presentation" class="divider"></li>\n<li role="presentation" class="ms-item"\nng-repeat="item in ms.items = (items | filter:ms.filterString) | ivhMultiSelectPaginate:ms.ixPage:ms.sizePage"\nselection-model\nselection-model-mode="ms.sel.mode"\nselection-model-type="ms.sel.type"\nselection-model-selected-attribute="ms.sel.selectedAttribute"\nselection-model-selected-attribute="ms.sel.selectedAttribute"\nselection-model-on-change="ms.sel.onChange(item)">\n<a role="menuitem">\n<!-- Must stop propagation on checkbox clicks when nested within the `a`\ntag otherwise `a` fires a click too and undoes the first click. We\nwant to honor the actual checkbox click. -->\n<input type="checkbox" ng-click="$event.stopPropagation()" />\n{{:: ms.getLabelFor(item)}}\n</a>\n</li>\n<li role="presentation" ng-hide="ms.items.length"\nivh-multi-select-no-results>\n</li>\n<li role="presentation" ng-if="ms.hasPager && ms.items.length > ms.sizePage">\n<div class="text-center"\nivh-pager\nivh-pager-total="ms.items.length"\nivh-pager-page-number="ms.ixPage"\nivh-pager-page-size="ms.sizePage"\nivh-pager-button-size="\'sm\'">\n</div>\n</li>\n</ul>\n</div>\n',transclude:!0,controllerAs:"ms",controller:["$document","$scope","ivhMultiSelectCore",function(a,b,c){var d=this;c.init(d,b),d.items=b.items,d.selectAllVisible=function(a){a=angular.isDefined(a)?a:!0;var b=d.sel.selectedAttribute;angular.forEach(d.items,function(c){c[b]=a,d.sel.onChange(c)})}}]}}),angular.module("ivh.multiSelect").filter("ivhMultiSelectCollect",["selectionModelOptions",function(a){"use strict";var b=a.get().selectedAttribute;return function(a,c,d,e){if(!a||!c)return a;var f=c[e||b],g=c[d||"id"],h=a.indexOf(g);return f&&-1===h?a.push(g):!f&&h>-1&&a.splice(h,1),a}}]),angular.module("ivh.multiSelect").filter("ivhMultiSelectPaginate",["$injector",function(a){"use strict";var b=function(a){return a};return a.has("ivhPaginateFilter")&&(b=a.get("ivhPaginateFilter")),b}]),angular.module("ivh.multiSelect").factory("ivhMultiSelectCore",["$injector","$interpolate","ivhMultiSelectSelm",function(a,b,c){"use strict";var d={};return d.init=function(d,e){var f=10,g=!0;d.isOpen=!1,d.filterString="",d.sel=c.options(e),d.enableMultiSelect="single"!==d.sel.mode,angular.forEach(c.propsMap(),function(a){var b=e.$watch(a[1],function(b){b&&(d.sel[a[0]]=b,"mode"===a[0]&&(d.enableMultiSelect="single"!==b))});e.$on("$destroy",b)}),d.sel.onChange=function(a){e.selOnChange({item:a})};var h=e.labelAttr||"label",i=e.labelExpr?b(e.labelExpr):null;d.getLabelFor=function(a){return i?i({item:a}):a[h]},d.hasPager=g&&a.has("ivhPaginateFilter"),d.ixPage=0,d.sizePage=f},d}]),angular.module("ivh.multiSelect").factory("ivhMultiSelectSelm",["selectionModelOptions",function(a){"use strict";var b={},c={type:"checkbox",mode:"multi-additive"};return b.propsMap=function(){return[["type","selectionModelType"],["mode","selectionModelMode"],["selectedAttribute","selectionModelSelectedAttribute"],["selectedClass","selectionModelSelectedClass"],["cleanupStategy","selectionModelCleanupStrategy"]]},b.options=function(d){var e=angular.extend({},a.get(),c);return angular.forEach(b.propsMap(),function(a){d[a[1]]&&(e[a[0]]=d[a[1]])}),e},b}]);